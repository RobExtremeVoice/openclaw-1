---
title: "Elevated(提權模式)"
summary: "提權執行模式與 `/elevated` 指示語說明"
read_when:
  - 調整提權模式的預設值、允許清單或斜線指令行為時
---

# 提權模式 (/elevated 指示語)

## 功能說明
提權模式主要用於控制**沙盒環境**中的 Agent 存取宿主機的能力（若未開啟沙盒，則 Agent 預設即在宿主機執行，提權模式僅具備狀態顯示意義）。

- `/elevated on` (或 `ask`)：允許在宿主機執行指令，但仍須遵循「執行核准」流程（依據配置決定是否彈窗詢問）。
- `/elevated full`：允許在宿主機執行指令，且**自動核准**所有操作（跳過執行核准流程）。
- `/elevated off`：強制 Agent 僅限於沙盒內執行。

## 控制權限與限制
- **全域開關**：由 `tools.elevated` 設定基礎權限。
- **個別 Agent 限制**：可透由 `agents.list[].tools.elevated` 進一步縮減特定 Agent 的提權權限（兩者皆須允許才能生效）。
- **會話狀態**：提權指示語會設定當前聊天會話的權限等級。
- **內嵌提示**：訊息中包含 `/elevated ...` 時，該等級僅適用於該次單一請求。
- **工具權限**：若 Agent 的工具清單中未包含 `exec`，則提權模式亦無法生效。
- **獨立性**：提權模式與 `/exec` 指令是分開的。`/exec` 用於調整授權操作者的預設參數，不一定需要提權標記。

## 設定優先順序 (Resolution Order)
1. **內嵌指示語**（隨訊息傳送，優先度最高，僅限單次）。
2. **會話覆寫**（發送僅包含指令的訊息，如單獨傳送 `/elevated full`）。
3. **全域預設值**（配置檔中的 `agents.defaults.elevatedDefault`）。

## 安全存取與允許清單 (Allowlists)
- **傳送者過濾**：使用 `tools.elevated.allowFrom` 設定可使用提權功能的發送者列表（依頻道區分）。
- **Agent 層級過濾**：設定於 Agent 個別配置中。傳送者必須**同時符合**全域與 Agent 層級的清單。
- **無權限處理**：若發送者不具備權限，提權指示語會回報錯誤且不變更會話狀態。

## 紀錄與狀態
- 提權後的 `exec` 呼叫會被記錄在 info 級別日誌中。
- `/status` 指令會顯示當前的提權模式（如 `elevated=ask` 或 `elevated=full`）。
